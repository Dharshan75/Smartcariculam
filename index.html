<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Smart Curriculum & Attendance</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; padding: 20px; }
    .container { max-width: 1000px; margin: 0 auto; background: white; border-radius: 12px; box-shadow: 0 20px 60px rgba(0,0,0,0.3); overflow: hidden; }
    header { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 30px; text-align: center; }
    header h1 { font-size: 28px; margin-bottom: 5px; }
    .tabs { display: flex; gap: 0; border-bottom: 2px solid #e0e0e0; background: #f5f5f5; }
    .tab-btn { flex: 1; padding: 15px; border: none; background: none; cursor: pointer; font-size: 14px; font-weight: 600; color: #666; border-bottom: 3px solid transparent; transition: all 0.3s; }
    .tab-btn.active { color: #667eea; border-bottom-color: #667eea; }
    .tab-btn:hover { background: #efefef; }
    .content { display: none; padding: 30px; }
    .content.active { display: block; animation: fadeIn 0.3s; }
    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    .input-group { display: flex; gap: 10px; margin-bottom: 20px; }
    input { flex: 1; padding: 12px; border: 1px solid #ddd; border-radius: 6px; font-size: 14px; }
    button { padding: 12px 20px; background: #667eea; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; transition: 0.3s; }
    button:hover { background: #764ba2; }
    table { width: 100%; border-collapse: collapse; margin-top: 20px; }
    th { background: #f0f0f0; padding: 12px; text-align: left; font-weight: 600; color: #333; }
    td { padding: 12px; border-bottom: 1px solid #e0e0e0; }
    tr:hover { background: #f9f9f9; }
    .badge { display: inline-block; padding: 6px 12px; border-radius: 20px; font-size: 12px; font-weight: 600; }
    .badge.present { background: #d4edda; color: #155724; }
    .badge.absent { background: #f8d7da; color: #721c24; }
    .badge.leave { background: #d1ecf1; color: #0c5460; }
    .stats { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 30px; }
    .stat-card { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px; border-radius: 8px; text-align: center; }
    .stat-card h3 { font-size: 32px; margin-bottom: 5px; }
    .stat-card p { font-size: 14px; opacity: 0.9; }
    .delete-btn { background: #dc3545; padding: 6px 12px; font-size: 12px; }
    .delete-btn:hover { background: #c82333; }
    .checkbox-group { display: flex; gap: 15px; flex-wrap: wrap; }
    label { display: flex; align-items: center; gap: 8px; cursor: pointer; }
    input[type="checkbox"] { cursor: pointer; }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>Smart Curriculum Activities & Attendance</h1>
      <p>Manage students, track attendance, and assign activities efficiently</p>
    </header>

    <div class="tabs">
      <button class="tab-btn active" onclick="switchTab('students')">Students</button>
      <button class="tab-btn" onclick="switchTab('attendance')">Attendance</button>
      <button class="tab-btn" onclick="switchTab('activities')">Activities</button>
      <button class="tab-btn" onclick="switchTab('dashboard')">Dashboard</button>
    </div>

    <!-- Students Tab -->
    <div id="students" class="content active">
      <h2>Manage Students</h2>
      <div class="input-group">
        <input type="text" id="studentName" placeholder="Enter student name">
        <input type="email" id="studentEmail" placeholder="Enter student email">
        <button onclick="addStudent()">Add Student</button>
      </div>
      <table>
        <thead>
          <tr><th>ID</th><th>Name</th><th>Email</th><th>Action</th></tr>
        </thead>
        <tbody id="studentList"></tbody>
      </table>
    </div>

    <!-- Attendance Tab -->
    <div id="attendance" class="content">
      <h2>Mark Attendance</h2>
      <div class="input-group">
        <input type="date" id="attendanceDate">
        <button onclick="loadAttendanceForm()">Load Students</button>
      </div>
      <div id="attendanceForm"></div>
      <button onclick="saveAttendance()" style="margin-top: 20px;">Save Attendance</button>
      <table style="margin-top: 30px;">
        <thead>
          <tr><th>Date</th><th>Student</th><th>Status</th></tr>
        </thead>
        <tbody id="attendanceList"></tbody>
      </table>
    </div>

    <!-- Activities Tab -->
    <div id="activities" class="content">
      <h2>Assign Activities</h2>
      <div class="input-group">
        <input type="text" id="activityName" placeholder="Activity name">
        <input type="date" id="activityDueDate">
        <button onclick="addActivity()">Add Activity</button>
      </div>
      <table>
        <thead>
          <tr><th>Activity</th><th>Due Date</th><th>Students Assigned</th><th>Action</th></tr>
        </thead>
        <tbody id="activityList"></tbody>
      </table>
    </div>

    <!-- Dashboard Tab -->
    <div id="dashboard" class="content">
      <h2>Dashboard</h2>
      <div class="stats">
        <div class="stat-card">
          <h3 id="totalStudents">0</h3>
          <p>Total Students</p>
        </div>
        <div class="stat-card">
          <h3 id="avgAttendance">0%</h3>
          <p>Avg Attendance</p>
        </div>
        <div class="stat-card">
          <h3 id="totalActivities">0</h3>
          <p>Total Activities</p>
        </div>
        <div class="stat-card">
          <h3 id="presentToday">0</h3>
          <p>Present Today</p>
        </div>
      </div>
      <button onclick="exportData()">Export Data as JSON</button>
    </div>
  </div>

  <script>
    const data = JSON.parse(localStorage.getItem('curriculumData')) || {
      students: [],
      attendance: [],
      activities: []
    };

    const switchTab = (tab) => {
      document.querySelectorAll('.content').forEach(el => el.classList.remove('active'));
      document.querySelectorAll('.tab-btn').forEach(el => el.classList.remove('active'));
      document.getElementById(tab).classList.add('active');
      event.target.classList.add('active');
      if (tab === 'dashboard') updateDashboard();
    };

    const addStudent = () => {
      const name = document.getElementById('studentName').value.trim();
      const email = document.getElementById('studentEmail').value.trim();
      if (!name || !email) return alert('Please fill all fields');
      data.students.push({ id: Date.now(), name, email });
      saveData();
      document.getElementById('studentName').value = '';
      document.getElementById('studentEmail').value = '';
      renderStudents();
    };

    const renderStudents = () => {
      const list = document.getElementById('studentList');
      list.innerHTML = data.students.map(s => `
        <tr>
          <td>${s.id}</td>
          <td>${s.name}</td>
          <td>${s.email}</td>
          <td><button class="delete-btn" onclick="deleteStudent(${s.id})">Delete</button></td>
        </tr>
      `).join('');
    };

    const deleteStudent = (id) => {
      data.students = data.students.filter(s => s.id !== id);
      saveData();
      renderStudents();
    };

    const loadAttendanceForm = () => {
      const date = document.getElementById('attendanceDate').value;
      if (!date) return alert('Please select a date');
      const form = document.getElementById('attendanceForm');
      form.innerHTML = `<div class="checkbox-group">` + data.students.map(s => `
        <label>
          <input type="checkbox" class="student-check" value="${s.id}" data-name="${s.name}">
          ${s.name} (Present)
        </label>
      `).join('') + `</div>`;
    };

    const saveAttendance = () => {
      const date = document.getElementById('attendanceDate').value;
      if (!date) return alert('Please select a date');
      const checked = document.querySelectorAll('.student-check:checked');
      checked.forEach(cb => {
        const status = 'present';
        data.attendance.push({ date, studentId: cb.value, studentName: cb.dataset.name, status });
      });
      data.students.forEach(s => {
        if (!checked.forEach(c => c.value === String(s.id))) {
          data.attendance.push({ date, studentId: s.id, studentName: s.name, status: 'absent' });
        }
      });
      saveData();
      renderAttendance();
      alert('Attendance saved!');
    };

    const renderAttendance = () => {
      const list = document.getElementById('attendanceList');
      list.innerHTML = data.attendance.map(a => `
        <tr>
          <td>${a.date}</td>
          <td>${a.studentName}</td>
          <td><span class="badge ${a.status}">${a.status.toUpperCase()}</span></td>
        </tr>
      `).join('');
    };

    const addActivity = () => {
      const name = document.getElementById('activityName').value.trim();
      const dueDate = document.getElementById('activityDueDate').value;
      if (!name || !dueDate) return alert('Please fill all fields');
      data.activities.push({ id: Date.now(), name, dueDate, assignedCount: data.students.length });
      saveData();
      document.getElementById('activityName').value = '';
      document.getElementById('activityDueDate').value = '';
      renderActivities();
    };

    const renderActivities = () => {
      const list = document.getElementById('activityList');
      list.innerHTML = data.activities.map(a => `
        <tr>
          <td>${a.name}</td>
          <td>${a.dueDate}</td>
          <td>${a.assignedCount}</td>
          <td><button class="delete-btn" onclick="deleteActivity(${a.id})">Delete</button></td>
        </tr>
      `).join('');
    };

    const deleteActivity = (id) => {
      data.activities = data.activities.filter(a => a.id !== id);
      saveData();
      renderActivities();
    };

    const updateDashboard = () => {
      document.getElementById('totalStudents').textContent = data.students.length;
      document.getElementById('totalActivities').textContent = data.activities.length;
      const today = new Date().toISOString().split('T')[0];
      const presentToday = data.attendance.filter(a => a.date === today && a.status === 'present').length;
      document.getElementById('presentToday').textContent = presentToday;
      const avgAtt = data.attendance.length > 0 ? Math.round((data.attendance.filter(a => a.status === 'present').length / data.attendance.length) * 100) : 0;
      document.getElementById('avgAttendance').textContent = avgAtt + '%';
    };

    const saveData = () => localStorage.setItem('curriculumData', JSON.stringify(data));
    const exportData = () => {
      const link = document.createElement('a');
      link.href = 'data:text/json;charset=utf-8,' + encodeURIComponent(JSON.stringify(data, null, 2));
      link.download = 'curriculum_data.json';
      link.click();
    };

    renderStudents();
    renderAttendance();
    renderActivities();
  </script>
</body>
</html>
